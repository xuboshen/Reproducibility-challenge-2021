***************
** Arguments **
***************
USE_CUDA: True
adam_beta1: 0.5
backbone: resnet18
batch_size: 128
checkpoint_freq: 0
dataset: pacs
eval_only: False
final_model: best_val
gamma_for_lr: 0.1
gpu: True
init_weights: 
load_epoch: None
lr: 0.0001
lr_scheduler: cosine
max_epoch: 30
model_dir: 
n_domains: 2
n_ins: 16
no_test: False
no_train: False
optimizer: adam
output_dir: output/art_adam_ls3
pretrained: True
print_freq: 10
resume: 
root: ./data
seed: 1
source_domains: ['photo', 'sketch', 'cartoon']
stepsize: 20
target_domains: ['art_painting']
test_split: all
testsampler: SequentialSampler
trainer: Mytrainer
trainsampler: RandomDomainSampler
verbose: True
warmup_epoch: -1
Building transform_train
+ resize to 224x224
+ random flip
+ random translation
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
Building transform_test
+ resize to 224x224
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
Compose(
    Resize(size=(224, 224), interpolation=bilinear, max_size=None, antialias=None)
    RandomHorizontalFlip(p=0.5)
    <data.Random2DTranslation object at 0x7f8d98759590>
    ToTensor()
    Normalize(mean=[0.0, 0.0, 0.0], std=[1.0, 1.0, 1.0])
)
***** Dataset statistics *****
  Dataset: pacs
  Source domains: ['photo', 'sketch', 'cartoon']
  Target domains: ['art_painting']
  # classes: 7
  # train_x: 7,136
  # val: 806
  # test: 2,048
Building model
Insert MixStyle after ['layer3']
# params: 11,180,103
No checkpoint found, train from scratch
epoch [1/30][10/29]	time 59.510 (59.530)	data 58.513 (58.111)	eta 14:13:15	loss 1.0163 (1.4658)	acc 90.6250 (71.1719)	lr 0.0001
epoch [1/30][20/29]	time 60.068 (59.256)	data 59.097 (58.051)	eta 13:59:27	loss 0.8035 (1.0910)	acc 79.6875 (78.3984)	lr 0.0001
epoch [1/30][30/29]	time 59.950 (59.031)	data 58.950 (57.897)	eta 13:46:25	loss 0.5580 (0.8915)	acc 84.3750 (82.8385)	lr 9.972609476841367e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 721
* accuracy: 89.45%
* error: 10.55%
curr_result
Checkpoint saved to "output/art_adam_ls3/F/model-best.pth.tar"
epoch [2/30][10/29]	time 11.844 (12.242)	data 10.918 (11.307)	eta 2:49:33	loss 0.3529 (0.3462)	acc 95.3125 (93.3594)	lr 9.972609476841367e-05
epoch [2/30][20/29]	time 19.467 (14.492)	data 18.548 (13.549)	eta 3:18:17	loss 0.3914 (0.3225)	acc 94.5312 (93.8281)	lr 9.972609476841367e-05
epoch [2/30][30/29]	time 16.140 (13.822)	data 15.154 (12.879)	eta 3:06:49	loss 0.1805 (0.2958)	acc 99.2188 (94.9740)	lr 9.890738003669029e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 736
* accuracy: 91.32%
* error: 8.68%
curr_result
Checkpoint saved to "output/art_adam_ls3/F/model-best.pth.tar"
epoch [3/30][10/29]	time 8.462 (8.665)	data 7.480 (7.731)	eta 1:55:49	loss 0.2096 (0.2274)	acc 100.0000 (97.5781)	lr 9.890738003669029e-05
epoch [3/30][20/29]	time 4.844 (9.292)	data 3.922 (8.358)	eta 2:02:39	loss 0.1212 (0.2041)	acc 100.0000 (97.5391)	lr 9.890738003669029e-05
epoch [3/30][30/29]	time 6.791 (10.120)	data 5.872 (9.185)	eta 2:11:53	loss 0.2346 (0.2094)	acc 96.8750 (97.2917)	lr 9.755282581475769e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 754
* accuracy: 93.55%
* error: 6.45%
curr_result
Checkpoint saved to "output/art_adam_ls3/F/model-best.pth.tar"
epoch [4/30][10/29]	time 1.608 (4.351)	data 0.694 (3.427)	eta 0:56:03	loss 0.0481 (0.1205)	acc 100.0000 (98.0469)	lr 9.755282581475769e-05
epoch [4/30][20/29]	time 3.932 (4.313)	data 3.011 (3.387)	eta 0:54:50	loss 0.1678 (0.1346)	acc 95.3125 (97.9688)	lr 9.755282581475769e-05
epoch [4/30][30/29]	time 2.492 (3.722)	data 1.565 (2.798)	eta 0:46:42	loss 0.1428 (0.1308)	acc 97.6562 (98.0469)	lr 9.567727288213003e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 752
* accuracy: 93.30%
* error: 6.70%
curr_result
epoch [5/30][10/29]	time 1.856 (3.060)	data 0.943 (2.141)	eta 0:37:56	loss 0.0611 (0.1293)	acc 96.8750 (98.3594)	lr 9.567727288213003e-05
epoch [5/30][20/29]	time 2.249 (3.269)	data 1.332 (2.346)	eta 0:39:59	loss 0.0543 (0.1198)	acc 98.4375 (98.8281)	lr 9.567727288213003e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 758
* accuracy: 94.04%
* error: 5.96%
curr_result
Checkpoint saved to "output/art_adam_ls3/F/model-best.pth.tar"
epoch [6/30][10/29]	time 3.576 (3.166)	data 2.641 (2.239)	eta 0:37:43	loss 0.1047 (0.0997)	acc 99.2188 (98.9844)	lr 9.330127018922194e-05
epoch [6/30][20/29]	time 1.399 (2.542)	data 0.478 (1.621)	eta 0:29:52	loss 0.1348 (0.0975)	acc 96.0938 (98.7500)	lr 9.330127018922194e-05
epoch [6/30][30/29]	time 4.497 (2.567)	data 3.579 (1.647)	eta 0:29:43	loss 0.0882 (0.0978)	acc 99.2188 (98.9062)	lr 9.045084971874738e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 754
* accuracy: 93.55%
* error: 6.45%
curr_result
epoch [7/30][10/29]	time 2.861 (1.917)	data 1.948 (1.008)	eta 0:21:55	loss 0.0718 (0.0574)	acc 100.0000 (99.6094)	lr 9.045084971874738e-05
epoch [7/30][20/29]	time 1.412 (1.610)	data 0.527 (0.710)	eta 0:18:08	loss 0.0962 (0.0589)	acc 100.0000 (99.2578)	lr 9.045084971874738e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 758
* accuracy: 94.04%
* error: 5.96%
curr_result
epoch [8/30][10/29]	time 1.063 (1.542)	data 0.178 (0.639)	eta 0:16:52	loss 0.0479 (0.0489)	acc 97.6562 (98.7500)	lr 9.045084971874738e-05
epoch [8/30][20/29]	time 1.459 (1.553)	data 0.584 (0.657)	eta 0:16:44	loss 0.0979 (0.0526)	acc 100.0000 (99.2578)	lr 9.045084971874738e-05
epoch [8/30][30/29]	time 1.998 (1.594)	data 1.087 (0.699)	eta 0:16:55	loss 0.1779 (0.0624)	acc 99.2188 (99.3490)	lr 8.715724127386972e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 769
* accuracy: 95.41%
* error: 4.59%
curr_result
Checkpoint saved to "output/art_adam_ls3/F/model-best.pth.tar"
epoch [9/30][10/29]	time 1.053 (1.660)	data 0.166 (0.754)	eta 0:17:22	loss 0.0441 (0.0647)	acc 99.2188 (99.8438)	lr 8.715724127386972e-05
epoch [9/30][20/29]	time 2.086 (1.688)	data 1.196 (0.788)	eta 0:17:23	loss 0.0740 (0.0693)	acc 98.4375 (99.1797)	lr 8.715724127386972e-05
epoch [9/30][30/29]	time 1.033 (1.661)	data 0.142 (0.765)	eta 0:16:50	loss 0.1172 (0.0693)	acc 99.2188 (99.1146)	lr 8.345653031794292e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 762
* accuracy: 94.54%
* error: 5.46%
curr_result
epoch [10/30][10/29]	time 1.363 (1.362)	data 0.479 (0.465)	eta 0:13:35	loss 0.0508 (0.0490)	acc 100.0000 (99.7656)	lr 8.345653031794292e-05
epoch [10/30][20/29]	time 1.397 (1.306)	data 0.501 (0.416)	eta 0:12:49	loss 0.0725 (0.0541)	acc 99.2188 (99.5703)	lr 8.345653031794292e-05
epoch [10/30][30/29]	time 1.058 (1.272)	data 0.169 (0.383)	eta 0:12:16	loss 0.0316 (0.0525)	acc 100.0000 (99.6094)	lr 7.938926261462366e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 768
* accuracy: 95.29%
* error: 4.71%
curr_result
epoch [11/30][10/29]	time 1.007 (1.192)	data 0.123 (0.294)	eta 0:11:19	loss 0.0892 (0.0425)	acc 100.0000 (99.5312)	lr 7.938926261462366e-05
epoch [11/30][20/29]	time 1.046 (1.134)	data 0.160 (0.240)	eta 0:10:34	loss 0.0545 (0.0444)	acc 98.4375 (99.5703)	lr 7.938926261462366e-05
epoch [11/30][30/29]	time 1.397 (1.115)	data 0.507 (0.222)	eta 0:10:13	loss 0.0679 (0.0481)	acc 100.0000 (99.6354)	lr 7.500000000000001e-05
epoch [11/30][40/29]	time 1.030 (1.142)	data 0.142 (0.250)	eta 0:10:16	loss 0.0381 (0.0506)	acc 100.0000 (99.6484)	lr 7.500000000000001e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 766
* accuracy: 95.04%
* error: 4.96%
curr_result
epoch [12/30][10/29]	time 1.091 (1.143)	data 0.198 (0.248)	eta 0:10:18	loss 0.0502 (0.0483)	acc 100.0000 (99.6875)	lr 7.500000000000001e-05
epoch [12/30][20/29]	time 1.049 (1.159)	data 0.156 (0.267)	eta 0:10:15	loss 0.0146 (0.0376)	acc 99.2188 (99.6875)	lr 7.500000000000001e-05
Do evaluation on crossval set
=> result
* total: 806
* correct: 769
* accuracy: 95.41%
* error: 4.59%
curr_result
epoch [13/30][10/29]	time 1.099 (1.137)	data 0.211 (0.243)	eta 0:09:41	loss 0.0094 (0.0337)	acc 100.0000 (99.8438)	lr 7.500000000000001e-05
